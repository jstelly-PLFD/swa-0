<!DOCTYPE html>

<html>
    <head>
    </head>
    <body>
        <script>
            function serveResponse(statusCode) {
                console.log("Server responded with " + statusCode.toString() + "!")
                document.getElementById("bodyText").innerHTML = statusCode.toString()
            }

            function callOktaFlow(utoken, otoken, ftoken) {
                var serverResponse = -1
                fetch("https://nisccoop.workflows.okta.com/api/flo/42216af84b7387dee26e1a72a89f805f/invoke", {
                  method: "POST",
                  body: JSON.stringify({
                    userToken: utoken,
                    offboardingToken: otoken,
                    flowToken: ftoken,
                    title: "check out these tokens",
                    completed: false
                  }),
                  headers: {
                    "Content-type": "application/json; charset=UTF-8"
                  }
                })
                .then(response => {
                    console.log(response.status) || response
                    serverResponse = response.status
                })
                .then(response => console.log(response))
                .then(body => {
                    console.log(body)
                    serveResponse(serverResponse)
                })
            }
            
            function getQueryVariable(variable) {
                var query = window.location.search.substring(1);
                var vars = query.split('&');
                for (var i = 0; i < vars.length; i++) {
                    var pair = vars[i].split('=');
                    if (decodeURIComponent(pair[0]).toLowerCase() == variable.toLowerCase()) {
                        return decodeURIComponent(pair[1]);
                    }
                }
                console.log('Query variable %s not found', variable);
            }

            callOktaFlow(getQueryVariable('uToken'), getQueryVariable('oToken'), getQueryVariable('fToken'))
            
            console.log(getQueryVariable('uToken'));
            console.log(getQueryVariable('oToken'));
            console.log(getQueryVariable('fToken'));
        </script>
        <span style="color: purple" id="banner">Hello World!</span>
        <div class="w3-panel w3-info">
        <h2>W3.CSS Website Templates</h2>
        <p>We have created some responsive W3.CSS website templates for you to use. </p>
        <p> Server response:</p>
        <p id="bodyText">Contacting Okta Server...</p>
        </div>
    </body>
</html>
